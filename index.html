<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Startpage</title>
  <link rel="stylesheet" href="./style.css">
</head>
<body>
  <img src="https://archlinux.org/static/logos/archlinux-logo-light-scalable.svg" alt="logo" id='logo'>
  <div class="searchbar">
    <input type="text" id='searchbar'>
    <img src="./search.svg" id='search' alt="" onclick=searchq(search.value)>
  </div>
  <div class="links-wrap"> 
    <div class="links" id='links'> 
    </div>
  </div>
  <script>
    const links = document.getElementById('links');
    const logo = document.getElementById('logo');
    const search = document.getElementById('searchbar');
    const searchbtn = document.getElementById('search');
    let defaultLinks = [
      {'name': 'YouTube', url: 'https://youtube.com'},
      {'name': 'Reddit', url: 'https://reddit.com'},
      {'name': 'Deepseek', url: 'https://chat.deepseek.com'},
      {'name': 'Discord', url: 'https://discord.com/channels/@me'},
    ] 
    const d = new Date();
    d.setTime(d.getTime() + (1000*24*60*60*1000));
    let expires = "expires=" + d.toUTCString();
    if (!getCookie('links')){
      document.cookie = 'links=' + JSON.stringify(defaultLinks) + ';expires=31 December 2040;';
    };
    if (!getCookie('logo_url')){
      document.cookie = 'logo_url=' + logo.src + ';expires=31 December 2040';
    } else {
      logo.src = getCookie('logo_url');
    };
    if (!getCookie('searchQuery')){
      document.cookie = 'searchQuery=https://duckduckgo.com/search?q=;expires=31 December 2040;';
    };
    function getCookie(cname) {
      let name = cname + "=";
      let ca = document.cookie.split(';');
      for(let i = 0; i < ca.length; i++) {
        let c = ca[i];
        while (c.charAt(0) == ' ') {
        c = c.substring(1);
      }
      if (c.indexOf(name) == 0) {
        return c.substring(name.length, c.length);
      }}}
    let linksc = JSON.parse(getCookie('links'));
    linksc.forEach((bookmark, index) => {
                links.innerHTML += `
                   <div class="link">
                     <a href="${bookmark.url}">
                       <img src='https://favicon.is/${bookmark.url.slice(8)}' alt="" class='link-img'>
                       <h1>${bookmark.name}</h1>
                      </a>
                   </div> 
                    `;});

    function searchq(value){
      window.location.href = getCookie('searchQuery') + value;
    }

    document.addEventListener('keypress', (key) => {
      if (key.key == 'Enter'){
        searchq(search.value);
      }
    }); 

    //console.log(linksc);
    //console.log(defaultLinks)
  </script>
</body>
</html>
